<mvc:View controllerName="iot.planner.components.singleplanningcalendar.controller.SinglePlanningCalendar"
	xmlns="sap.m"
	xmlns:unified="sap.ui.unified"
	xmlns:f="sap.ui.layout.form"
	xmlns:l="sap.ui.layout"
	xmlns:core="sap.ui.core"
	xmlns:table="sap.ui.table"
	xmlns:mvc="sap.ui.core.mvc" displayBlock="true">
	<Shell id="shell">
		<App id="app" busy="{/busy}" busyIndicatorDelay="0">
			<pages>
				<Page showHeader="false">
					<SinglePlanningCalendar id="SPCalendar" appointments="{/MyWorkItems}" appointmentSelect="onPressAppointment" appointmentCreate="onCreateAppointment" appointmentResize="onEditAppointment" appointmentDrop="onEditAppointment" startDateChange="onStartDateChange" viewChange="onChangeView" startHour="7" endHour="20" fullDay="false" enableAppointmentsCreate="true" enableAppointmentsResize="true" enableAppointmentsDragAndDrop="true">
						<actions>
							<Button id="createAppointment" text="{i18n>createAppointment.button.text}" press="onCreateAppointment" tooltip="{i18n>createAppointment.button.tooltip}" />
							<Button id="displayLegend" text="{i18n>displayLegend.button.text}" press="onDisplayLegend" tooltip="{i18n>displayLegend.button.tooltip}" />
						</actions>
						<appointments>
							<unified:CalendarAppointment startDate="{activatedDate}" endDate="{completedDate}" title="{parent/absoluteReference} {title}" text="{parent/deepReference}" type="{parts: ['source', 'status'], formatter: '.formatter.getDisplayType'}" tentative="{= !${confirmed}}"/>
							<!-- icon="{path: 'customer_friendlyID', formatter: '.formatter.getIconURL'}" -->
						</appointments>
						<dependents>
							<Dialog id="createItemDialog" busy="{/dialogBusy}" afterClose="onAfterCloseDialog" afterOpen="onAfterOpenDialog" contentHeight="50vh" contentWidth="40vw">
								<customHeader>
									<Bar>
										<contentLeft>
											<Title text="{/createItemDialogTitle} {= !${confirmed} ? ${i18n>appointmentDialog.draftIndicator} : ''}"/>
										</contentLeft>
										<contentRight>
											<Button press="onPressResetAppointment" text="{i18n>resetEntry.button.text}" tooltip="{i18n>resetEntry.button.tooltip}" enabled="{= ${source} !== 'Manual' &amp;&amp; !!${confirmed} &amp;&amp; !${isAllDay}}"/>
											<Button press="onPressDeleteAppointment" text="{i18n>deleteEntry.button.text}" tooltip="{i18n>deleteEntry.button.tooltip}" enabled="{= !${isAllDay}}"/>
										</contentRight>
									</Bar>
								</customHeader>
								<MessageStrip text="{i18n>message.allDayEventsAreNotEditable}" visible="{= !!${isAllDay}}" class="sapUiTinyMargin"/>
								<f:Form id="appointmentForm" editable="true">
									<f:layout>
										<f:ResponsiveGridLayout labelSpanXL="4" labelSpanL="4" labelSpanM="12" labelSpanS="12" adjustLabelSpan="false" emptySpanXL="0" emptySpanL="0" emptySpanM="0" emptySpanS="0" columnsXL="2" columnsL="2" columnsM="2" singleContainerFullSize="false" />
									</f:layout>
									<f:formContainers>
										<f:FormContainer>
											<f:formElements>
												<f:FormElement label="{i18n>WorkItems.title}">
													<f:fields>
														<Input value="{title}"/>
													</f:fields>
												</f:FormElement>
												<f:FormElement label="{i18n>WorkItems.hierarchy}">
													<f:fields>
														<Input id="hierarchySearch" value="{parentPath}" suggestionItems="{/MyCategories}" liveChange="onChangeHierarchy">
															<suggestionItems>
																<core:Item text="{path}" key="{ID}"/>
															</suggestionItems>
														</Input>
													</f:fields>
												</f:FormElement>
												<f:FormElement>
													<f:fields>
														<Tree mode="SingleSelectMaster" selectionChange="onSelectHierarchy" id="hierarchyTree" items="{path: '/MyCategoriesNested', sorter: [{path: 'shallowReference'}], parameters: {numberOfExpandedLevels: 5, arrayNames: ['children']}}">
															<StandardTreeItem title="{parts: ['absoluteReference', 'shallowReference', 'title'], formatter: '.formatter.getReferenceAndText'}" />
														</Tree>
													</f:fields>
												</f:FormElement>
											</f:formElements>
										</f:FormContainer>
										<f:FormContainer>
											<f:formElements>
												<f:FormElement label="{i18n>WorkItems.tags}">
													<f:fields>
														<MultiInput tokens="{path: 'tags', templateShareable: false}" suggestionItems="{
															path: 'OData>/Tags',
															templateShareable: false,
															sorter: { path: 'title' }
														}" showValueHelp="false" tokenUpdate="onUpdateTags">
															<suggestionItems>
																<core:Item key="{OData>title}" text="{OData>title}"/>
															</suggestionItems>
															<tokens>
																<Token key="{tag_title}" text="{tag_title}" delete="onDeleteToken"/>
															</tokens>
														</MultiInput>
														<Text text="{/hierarchySuggestion}"/>
													</f:fields>
												</f:FormElement>
												<f:FormElement label="{i18n>WorkItems.activatedDate}">
													<f:fields>
														<DateTimePicker value="{path:'activatedDate', type:'sap.ui.model.type.DateTime', formatOptions: {style: 'short'}}" minutesStep="15"/>
													</f:fields>
												</f:FormElement>
												<f:FormElement label="{i18n>WorkItems.completedDate}">
													<f:fields>
														<DateTimePicker value="{path: 'completedDate', type:'sap.ui.model.type.DateTime', formatOptions: {style: 'short'}}" minutesStep="15"/>
													</f:fields>
												</f:FormElement>
											</f:formElements>
										</f:FormContainer>
									</f:formContainers>
								</f:Form>

								<buttons>
									<Button id="submitButton" text="{i18n>OK}" press="onSubmitEntry" enabled="{= !!${title} &amp;&amp; !!${parentPath} &amp;&amp; !${isAllDay}}" type="Emphasized"/>
									<Button text="{i18n>close}" press="onCloseDialog" />
								</buttons>
							</Dialog>
							<Dialog id="legendDialog" title="{i18n>legend.title}">
								<PlanningCalendarLegend id="singlePlanningCalendarLegend" items="{path : '/legendItems', templateShareable: true}" class="sapUiSmallMarginTop">
									<items>
										<unified:CalendarLegendItem text="{text}" type="{type}" />
									</items>
								</PlanningCalendarLegend>
								<buttons>
									<Button text="{i18n>close}" press="onCloseDialog" />
								</buttons>
							</Dialog>
						</dependents>
						<views>
							<SinglePlanningCalendarDayView key="Day" id="dayView" title="{i18n>calendar.dayView}" />
							<SinglePlanningCalendarWorkWeekView key="WorkWeek" title="{i18n>calendar.workWeekView}" />
							<SinglePlanningCalendarWeekView key="Week" title="{i18n>calendar.weekView}"/>
							<SinglePlanningCalendarMonthView key="Month" id="monthView" title="{i18n>calendar.monthView}" />
						</views>
					</SinglePlanningCalendar>
				</Page>
			</pages>
		</App>
	</Shell>
</mvc:View>