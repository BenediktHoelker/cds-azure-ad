<mvc:View xmlns:mvc="sap.ui.core.mvc"
	xmlns:core="sap.ui.core"
	xmlns="sap.m"
	xmlns:layout="sap.ui.layout"
	xmlns:form="sap.ui.layout.form"
	xmlns:f="sap.f"
	xmlns:fb="sap.ui.comp.filterbar"
	xmlns:c="iot.planner.components.workitems.control"
	xmlns:t="sap.ui.table"
	xmlns:sfb="sap.ui.comp.smartfilterbar"
	xmlns:sf="sap.ui.comp.smartfield"
	xmlns:st="sap.ui.comp.smarttable" controllerName="iot.planner.components.workitems.controller.WorkItems">
	<Shell id="shell" appWidthLimited="false">
		<App busy="{/busy}" busyIndicatorDelay="0">
			<Page>
				<dependents>
					<Popover id="hierarchyPopover" contentWidth="42vw" placement="VerticalPreferredBottom">
						<t:TreeTable selectionMode="Single" rowSelectionChange="onSelectHierarchyTable" id="hierarchyTreeTable" rows="{path: 'viewModel>/MyCategoriesNested', sorter: [{path: 'viewModel>shallowReference'}], parameters: {numberOfExpandedLevels: 5, arrayNames: ['children']}}" visibleRowCount="auto" selectionBehavior="RowOnly" sort="onSort" columnHeaderVisible="false">
							<t:noData>
								<Text text=""/>
							</t:noData>
							<t:columns>
								<t:Column>
									<t:template>
										<FormattedText htmlText="{parts: ['viewModel>title', 'viewModel>deepReference'], formatter: '.formatter.braceDeepReference'}"/>
										<!-- <Text text="{viewModel>title}"/> -->
									</t:template>
								</t:Column>
								<!-- <t:Column width="163px">
										<t:template>
											<Text text="{viewModel>deepReference}"/>
										</t:template>
									</t:Column> -->
								<t:Column width="57px">
									<t:template>
										<Text text="{viewModel>absoluteReference}"/>
									</t:template>
								</t:Column>
							</t:columns>
						</t:TreeTable>
					</Popover>
				</dependents>
				<customHeader>
					<f:ShellBar title="{i18n>title}"/>
				</customHeader>
				<content>
					<f:DynamicPage showFooter="true">
						<f:header>
							<f:DynamicPageHeader pinnable="true">
								<f:content>
									<sfb:SmartFilterBar id="filterBarItems" entitySet="MyWorkItems" clear="clearFilter" showClearButton="true" showClearOnFB="true" considerSelectionVariants="true">
										<sfb:controlConfiguration>
											<sfb:ControlConfiguration key="Search" index="0" label="Search">
												<!-- <sfb:customControl>
													<SearchField search="search">
														<layoutData>
															<OverflowToolbarLayoutData maxWidth="200px" priority="NeverOverflow"/>
														</layoutData>
													</SearchField>
												</sfb:customControl> -->
											</sfb:ControlConfiguration>
											<sfb:ControlConfiguration key="Validated" filterType="multiple"/>
										</sfb:controlConfiguration>
										<sfb:layoutData>
											<FlexItemData shrinkFactor="0"/>
										</sfb:layoutData>
									</sfb:SmartFilterBar>
									<!-- <fb:FilterBar id="filterBarItems" useToolbar="false" search=".onSearch" showGoOnFB="false">
										<fb:filterGroupItems>
											<fb:FilterGroupItem groupName="filterItems" name="Time" label="{i18n>filterTime}" visibleInFilterBar="true">
												<fb:control>
													<DateRangeSelection displayFormat="dd.MM.yyyy" showCurrentDateButton="true" change=".onFilterDateRange"/>
												</fb:control>
											</fb:FilterGroupItem>
											<fb:FilterGroupItem groupName="filterItems" name="Customer" label="{i18n>filterCustomer}" visibleInFilterBar="true">
												<fb:control>
													<MultiComboBox items="{viewModel>/MyCustomers}" selectionChange=".onFilter">
														<core:Item key="{viewModel>title}" text="{viewModel>title}"/>
													</MultiComboBox>
												</fb:control>
											</fb:FilterGroupItem>
											<fb:FilterGroupItem groupName="filterItems" name="Project" label="{i18n>filterProject}" visibleInFilterBar="true">
												<fb:control>
													<MultiComboBox items="{viewModel>/MyProjects}" selectionChange=".onFilter">
														<core:Item key="{viewModel>title}" text="{viewModel>title}"/>
													</MultiComboBox>
												</fb:control>
											</fb:FilterGroupItem>
											<fb:FilterGroupItem groupName="filterItems" name="SubProject" label="{i18n>filterSubProject}" visibleInFilterBar="true">
												<fb:control>
													<MultiComboBox items="{viewModel>/MySubProjects}" selectionChange=".onFilter">
														<core:Item key="{viewModel>title}" text="{viewModel>title}"/>
													</MultiComboBox>
												</fb:control>
											</fb:FilterGroupItem>
											<fb:FilterGroupItem groupName="filterItems" name="WorkPackage" label="{i18n>filterWorkPackage}" visibleInFilterBar="true">
												<fb:control>
													<MultiComboBox items="{viewModel>/MyWorkPackages}" selectionChange=".onFilter">
														<core:Item key="{viewModel>title}" text="{viewModel>title}"/>
													</MultiComboBox>
												</fb:control>
											</fb:FilterGroupItem>
											<fb:FilterGroupItem groupName="filterItems" name="User" label="{i18n>filterUser}" visibleInFilterBar="true">
												<fb:control>
													<MultiComboBox items="{/Users}" selectionChange=".onFilter">
														<core:Item key="{title}" text="{displayName}"/>
													</MultiComboBox>
												</fb:control>
											</fb:FilterGroupItem>
											Kommentar Anfang
											<fb:FilterGroupItem groupName="filterItems" name="Category" label="{i18n>filterCategory}" visibleInFilterBar="true">
												<fb:control>
													<vBox>
														<Input id="hierarchySearchFilter" value="{viewModel>/filterHierarchy/parentPath}" suggestionItems="{viewModel>/MyCategories}" liveChange="onLiveChangeHierarchyFilter">
															<suggestionItems>
																<core:Item text="{path}" key="{ID}"/>
															</suggestionItems>
														</Input>
														<t:TreeTable selectionMode="Single" rowSelectionChange="onSelectHierarchyFilter" id="hierarchyTreeFilter" rows="{path: 'viewModel>/MyCategoriesNested', sorter: [{path: 'shallowReference'}], parameters: {numberOfExpandedLevels: 5, arrayNames: ['children']}}" visibleRowCount="10" selectionBehavior="RowOnly" sort="onSort" columnHeaderVisible="false">
															<t:noData>
																<Text text=""/>
															</t:noData>
															<t:columns>
																<t:Column>
																	<t:template>
																		<Text text="{parts: ['viewModel>title', 'viewModel>deepReference'], formatter: '.formatter.braceDeepReference'}"/>
																		<Text text="{title}"/>
																	</t:template>
																</t:Column>
																<t:Column width="163px">
																	<t:template>
																		<Text text="{deepReference}"/>
																	</t:template>
																</t:Column>
																<t:Column width="57px">
																	<t:template>
																		<Text text="{viewModel>absoluteReference}"/>
																	</t:template>
																</t:Column>
															</t:columns>
														</t:TreeTable>
													</vBox>
												</fb:control>
											</fb:FilterGroupItem>
											Kommentar Ende
										</fb:filterGroupItems>
									</fb:FilterBar> -->
								</f:content>
							</f:DynamicPageHeader>
						</f:header>
						<f:content>
							<st:SmartTable id="tableWorkItems" smartFilterId="filterBarItems" entitySet="MyWorkItems" tableType="ResponsiveTable" header="{i18n>title}" enableAutoBinding="true" class="sapUiResponsiveContentPadding">
								<st:customToolbar>
									<OverflowToolbar design="Transparent">
										<ToolbarSpacer/>
										<Button text="{i18n>tableButtonDelete}" press="onPressDeleteWorkItems"/>
									</OverflowToolbar>
								</st:customToolbar>
								<st:layoutData>
									<FlexItemData growFactor="1" baseSize="0%"/>
								</st:layoutData>
								<!-- <Table id="js-worklistTable" growing="true" growingScrollToLoad="true" growingThreshold="40">
									<ColumnListItem type="Navigation" press="navToFBMEntry"/>
								</Table> -->
							</st:SmartTable>
							<!-- <Table id="tableWorkItems" growing="true" growingScrollToLoad="true" width="auto" mode="MultiSelect" fixedLayout="false" busy="{viewModel>/tableBusy}" busyIndicatorDelay="0" updateFinished=".onUpdateTableFinished" items="{}">
								<headerToolbar>
									<OverflowToolbar>
									Kommentar Anfang
																				<SegmentedButton selectedKey="all" selectionChange=".onFilterState">
											<items>
												<SegmentedButtonItem key="all" text="{i18n>tableFilterShowAll} ({viewModel>/countAll})"/>
												<SegmentedButtonItem key="completed" text="{i18n>tableFilterCompleted} ({viewModel>/countCompleted})"/>
												<SegmentedButtonItem key="incompleted" text="{i18n>tableFilterIncompleted} ({viewModel>/countIncompleted})"/>
											</items>
										</SegmentedButton>
										Kommentar Ende
										<ToolbarSpacer/>
										<Button text="{i18n>tableButtonDelete}" press="onPressDeleteWorkItems"/>
										Kommentar Anfang
																				<Button tooltip="Sort" icon="sap-icon://sort" press="handleSortButtonPressed"/>
										<Button tooltip="Filter" icon="sap-icon://filter" press="handleFilterButtonPressed"/>
										<SearchField liveChange=".onSearch" width="20rem"/>
										Kommentar Ende
									</OverflowToolbar>
								</headerToolbar>
								<columns>
									<Column minScreenWidth="Tablet">
										<Text text="{i18n>tableColumnHierarchy}"/>
									</Column>
									<Column>
										<Text text="{i18n>tableColumnTitle}"/>
									</Column>
									<Column>
										<Text text="{i18n>tableColumnDate}" wrapping="false"/>
									</Column>
									<Column>
										<Text text="{i18n>tableColumnActivatedDate}" wrapping="false"/>
									</Column>
									<Column>
										<Text text="{i18n>tableColumnCompletedDate}" wrapping="false"/>
									</Column>
									<Column hAlign="End">
										<Text text="{i18n>tableColumnDuration}" wrapping="false"/>
										Kommentar Anfang
																				<footer>
											<ObjectNumber number="{/totalDuration}" unit="h"/>
										</footer>
										Kommentar Ende
									</Column>
									<Column minScreenWidth="Desktop">
										<Text text="{i18n>tableColumnActivity}"/>
									</Column>
									<Column minScreenWidth="Desktop">
										<Text text="{i18n>tableColumnLocation}"/>
									</Column>
									<Column width="3vw">
										<Text text="{i18n>tableColumnStatus}" wrapping="false"/>
									</Column>
								</columns>
								<items>
									<ColumnListItem press=".onPress" highlight="{= ${state} === 'completed' ? 'Success' : 'Warning'}">
										<cells>
											<Input id="hierarchySearchTable" value="{parentPath}" suggestionItems="{path: 'viewModel>/MyCategories', templateShareable: false}" liveChange="onLiveChangeHierarchyTable" width="24vw" change="onChangeWorkItemValue">
												<suggestionItems>
													<core:Item key="{ID}" text="{path}"/>
												</suggestionItems>
											</Input>
											<TextArea value="{title}" rows="1" growing="true" growingMaxLines="6" change="onChangeWorkItemValue" />
											<DatePicker value="{path: 'date' , type: 'sap.ui.model.type.Date', formatOptions: {pattern: 'dd.MM.yyyy'}}" width="9em" change="updateWorkItemDates"/>
											<TimePicker value="{path: 'activatedDate', type: 'sap.ui.model.odata.type.DateTime', formatOptions: {pattern : 'HH:mm'}}" minutesStep="15" width="7em" change="updateWorkItemDates"/>
											<TimePicker value="{path: 'completedDate', type: 'sap.ui.model.odata.type.DateTime', formatOptions: {pattern : 'HH:mm'}}" minutesStep="15" width="7em" change="updateWorkItemDates"/>
											<ObjectNumber number="{duration}" unit="h"/>
											<Select id="selectActivityTable" items="{viewModel>/activities}" selectedKey="{activity}" change="onChangeWorkItemValue">
												<items>
													<core:Item key="{viewModel>title}" text="{viewModel>title}"/>
												</items>
											</Select>
											<ComboBox id="selectLocationTable" items="{path: 'viewModel>/locations', templateShareable: false}" selectedKey="{location}" change="onChangeWorkItemValue">
												<items>
													<core:Item key="{viewModel>title}" text="{viewModel>title}"/>
												</items>
											</ComboBox>
											<c:If condition="{= ${state} === 'completed'}">
												<ObjectStatus class="sapUiTinyMargin" icon="sap-icon://sys-enter-2" state="Success"/>
												<ObjectStatus class="sapUiTinyMargin" icon="sap-icon://alert" state="Warning"/>
											</c:If>
										</cells>
									</ColumnListItem>
								</items>
							</Table> -->
						</f:content>
					</f:DynamicPage>
				</content>
			</Page>
		</App>
	</Shell>
</mvc:View>
