<mvc:View xmlns:mvc="sap.ui.core.mvc"
	xmlns:core="sap.ui.core"
	xmlns="sap.m"
	xmlns:layout="sap.ui.layout"
	xmlns:form="sap.ui.layout.form"
	xmlns:f="sap.f"
	xmlns:c="iot.planner.components.workitemsfastentry.control"
	xmlns:t="sap.ui.table" controllerName="iot.planner.components.workitemsfastentry.controller.WorkItemsFastEntry">
	<Page id="page" class="sapUiSizeCompact">
		<dependents>
			<t:TreeTable selectionMode="Single" rowSelectionChange="onSelectHierarchy($event, 'hierarchyTreeTable')" id="hierarchyTreeTable" rows="{path: '/MyCategoriesNested', sorter: [{path: 'shallowReference'}], parameters: {numberOfExpandedLevels: 5, arrayNames: ['children']}}" visibleRowCount="auto" selectionBehavior="RowOnly" sort="onSort" columnHeaderVisible="false" width="24vw">
				<t:noData>
					<Text text=""/>
				</t:noData>
				<t:columns>
					<t:Column>
						<t:template>
							<FormattedText htmlText="{parts: ['title', 'deepReference'], formatter: '.formatter.braceDeepReference'}"/>
							<!-- <Text text="{title}"/> -->
						</t:template>
					</t:Column>
					<!-- <t:Column width="163px">
										<t:template>
											<Text text="{deepReference}"/>
										</t:template>
									</t:Column> -->
					<t:Column width="57px">
						<t:template>
							<Text text="{absoluteReference}"/>
						</t:template>
					</t:Column>
				</t:columns>
			</t:TreeTable>
		</dependents>
		<customHeader>
			<f:ShellBar title="{i18n>title}"/>
		</customHeader>
		<content>
			<form:Form id="formNewWorkItem" editable="true">
				<form:layout>
					<form:ResponsiveGridLayout emptySpanXL="0" labelSpanXL="12" labelSpanL="12" labelSpanM="12" labelSpanS="12" adjustLabelSpan="false" columnsXL="2" columnsL="2" columnsM="1" singleContainerFullSize="false" />
				</form:layout>
				<form:formContainers>
					<form:FormContainer>
						<form:formElements>
							<form:FormElement label="{i18n>formTextAreaTitle}">
								<TextArea id="textAreaTitle" value="{/newWorkItem/title}" rows="1" growing="true" growingMaxLines="6" width="100%"/>
							</form:FormElement>
							<form:FormElement label="{i18n>formTimePickerActivatedAndCompletedDate}">
								<TimePicker value="{path: '/newWorkItem/activatedDate', type: 'sap.ui.model.odata.type.DateTime', formatOptions: {pattern : 'HH:mm'}}" minutesStep="15"/>
								<TimePicker value="{path: '/newWorkItem/completedDate', type: 'sap.ui.model.odata.type.DateTime', formatOptions: {pattern : 'HH:mm'}}" minutesStep="15"/>
							</form:FormElement>
							<form:FormElement label="{i18n>formDatePickerDate}">
								<DatePicker id="date" value="{ path: '/newWorkItem/date', type: 'sap.ui.model.type.Date', formatOptions: {pattern: 'dd.MM.yyyy'}}"/>
							</form:FormElement>
							<form:FormElement label="{i18n>formSelectActivity}">
								<Select id="selectActivityForm" items="{/activities}" selectedKey="{/newWorkItem/activity}">
									<items>
										<core:Item key="{title}" text="{title}"/>
									</items>
								</Select>
							</form:FormElement>
							<form:FormElement label="{i18n>formComboBoxLocation}">
								<ComboBox id="selectLocationForm" items="{/locations}" selectedKey="{/newWorkItem/location}">
									<items>
										<core:Item key="{title}" text="{title}"/>
									</items>
								</ComboBox>
							</form:FormElement>
						</form:formElements>
					</form:FormContainer>
					<form:FormContainer>
						<form:formElements>
							<form:FormElement label="{i18n>formInputHierarchy}">
								<form:fields>
									<Input id="hierarchySearchForm" value="{/newWorkItem/parentPath}" suggestionItems="{/MyCategories}" liveChange="onLiveChangeHierarchyForm">
										<suggestionItems>
											<core:Item text="{path}" key="{ID}"/>
										</suggestionItems>
									</Input>
								</form:fields>
							</form:FormElement>
							<form:FormElement>
								<form:fields>
									<t:TreeTable selectionMode="Single" rowSelectionChange="onSelectHierarchy($event, 'hierarchyTreeForm')" id="hierarchyTreeForm" rows="{path: '/MyCategoriesNested', sorter: [{path: 'shallowReference'}], parameters: {numberOfExpandedLevels: 5, arrayNames: ['children']}}" visibleRowCount="15" selectionBehavior="RowOnly" sort="onSort" columnHeaderVisible="false">
										<t:noData>
											<Text text=""/>
										</t:noData>
										<t:columns>
											<t:Column>
												<t:template>
													<Text text="{parts: ['title', 'deepReference'], formatter: '.formatter.braceDeepReference'}"/>
													<!-- <Text text="{title}"/> -->
												</t:template>
											</t:Column>
											<!-- <t:Column width="163px">
																	<t:template>
																		<Text text="{deepReference}"/>
																	</t:template>
																</t:Column> -->
											<t:Column width="57px">
												<t:template>
													<Text text="{absoluteReference}"/>
												</t:template>
											</t:Column>
										</t:columns>
									</t:TreeTable>
								</form:fields>
							</form:FormElement>
							<form:FormElement>
								<FlexBox justifyContent="End">
									<Button text="{i18n>formButtonSubmit}" press=".onPressSubmitWorkItem" type="Emphasized"/>
								</FlexBox>
							</form:FormElement>
						</form:formElements>
					</form:FormContainer>
				</form:formContainers>
			</form:Form>
			<Table id="tableWorkItems" growing="true" growingScrollToLoad="true" width="auto" mode="MultiSelect" fixedLayout="false" busy="{/tableBusy}" busyIndicatorDelay="0" updateFinished=".onUpdateTableFinished" items="{
								path: '/WorkItemsFastEntry',
								sorter: {
									path: 'completedDate',
									descending: false
								}
							}">
				<headerToolbar>
					<OverflowToolbar>
						<SegmentedButton selectedKey="all" selectionChange=".onFilterWorkItems">
							<items>
								<SegmentedButtonItem key="all" text="{i18n>tableFilterShowAll} ({/countAll})"/>
								<SegmentedButtonItem key="completed" text="{i18n>tableFilterCompleted} ({/countCompleted})"/>
								<SegmentedButtonItem key="incompleted" text="{i18n>tableFilterIncompleted} ({/countIncompleted})"/>
							</items>
						</SegmentedButton>
						<ToolbarSpacer/>
						<Button text="{i18n>tableButtonDelete}" press="onPressDeleteWorkItems"/>
						<SearchField liveChange=".onSearch" width="20rem"/>
					</OverflowToolbar>
				</headerToolbar>
				<columns>
					<Column minScreenWidth="Tablet">
						<Text text="{i18n>tableColumnHierarchy}"/>
					</Column>
					<Column>
						<Text text="{i18n>tableColumnTitle}"/>
					</Column>
					<Column>
						<Text text="{i18n>tableColumnDate}" wrapping="false"/>
					</Column>
					<Column>
						<Text text="{i18n>tableColumnActivatedDate}" wrapping="false"/>
					</Column>
					<Column>
						<Text text="{i18n>tableColumnCompletedDate}" wrapping="false"/>
					</Column>
					<Column hAlign="End">
						<Text text="{i18n>tableColumnDuration}" wrapping="false"/>
						<footer>
							<ObjectNumber number="{/totalDuration}" unit="h"/>
						</footer>
					</Column>
					<Column minScreenWidth="Desktop">
						<Text text="{i18n>tableColumnActivity}"/>
					</Column>
					<Column minScreenWidth="Desktop">
						<Text text="{i18n>tableColumnLocation}"/>
					</Column>
					<Column width="3vw">
						<Text text="{i18n>tableColumnStatus}" wrapping="false"/>
					</Column>
				</columns>
				<items>
					<ColumnListItem press=".onPress" highlight="{= ${state} === 'completed' ? 'Success' : 'Warning'}" vAlign="Top">
						<cells>
							<VBox>
								<Input id="hierarchySearchTable" value="{parentPath}" suggestionItems="{path: '/MyCategories', templateShareable: false}" liveChange="onLiveChangeHierarchyTable" width="24vw" change="updateWorkItem">
									<suggestionItems>
										<core:Item key="{ID}" text="{path}"/>
									</suggestionItems>
								</Input>
							</VBox>
							<TextArea value="{title}" rows="1" growing="true" growingMaxLines="6" change="updateWorkItem" />
							<DatePicker value="{path: 'date' , type: 'sap.ui.model.type.Date', formatOptions: {pattern: 'dd.MM.yyyy'}}" width="9em" change="updateWorkItemDates"/>
							<TimePicker value="{path: 'activatedDate', type: 'sap.ui.model.odata.type.DateTime', formatOptions: {pattern : 'HH:mm'}}" minutesStep="15" width="7em" change="updateWorkItemDates"/>
							<TimePicker value="{path: 'completedDate', type: 'sap.ui.model.odata.type.DateTime', formatOptions: {pattern : 'HH:mm'}}" minutesStep="15" width="7em" change="updateWorkItemDates"/>
							<ObjectNumber number="{duration}" unit="h"/>
							<Select id="selectActivityTable" items="{/activities}" selectedKey="{activity}" change="updateWorkItemActivity">
								<items>
									<core:Item key="{title}" text="{title}"/>
								</items>
							</Select>
							<ComboBox id="selectLocationTable" items="{path: '/locations', templateShareable: false}" selectedKey="{location}" change="updateWorkItemLocation">
								<items>
									<core:Item key="{title}" text="{title}"/>
								</items>
							</ComboBox>
							<c:If condition="{= ${state} === 'completed'}">
								<ObjectStatus class="sapUiTinyMargin" icon="sap-icon://sys-enter-2" state="Success"/>
								<ObjectStatus class="sapUiTinyMargin" icon="sap-icon://alert" state="Warning"/>
							</c:If>
						</cells>
					</ColumnListItem>
				</items>
			</Table>
		</content>
	</Page>
</mvc:View>
